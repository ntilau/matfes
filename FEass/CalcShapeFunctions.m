function [Shape,ShapeDerivX,ShapeDerivY] = ShapeFunctions(dim, p)
Shape = inline('');
ShapeDerivX = inline('');
ShapeDerivY = inline('');
switch dim
    case 1
        switch p
            case 1
                Shape = inline('[ 1 - x, x]','x');
                ShapeDerivX = inline('[-1, 1]','x');
            case 2
                Shape = inline('[ (2*x - 1)*(x - 1), x*(2*x - 1), -4*x*(x - 1)]','x');
                ShapeDerivX = inline('[ 4*x - 3, 4*x - 1, 4 - 8*x]','x');
            case 3
                Shape = inline('[ -((3*x - 1)*(3*x - 2)*(x - 1))/2, (x*(3*x - 1)*(3*x - 2))/2, (9*x*(3*x - 2)*(x - 1))/2, -(9*x*(3*x - 1)*(x - 1))/2]','x');
                ShapeDerivX = inline('[ 18*x - (27*x^2)/2 - 11/2, (27*x^2)/2 - 9*x + 1, (81*x^2)/2 - 45*x + 9, 36*x - (81*x^2)/2 - 9/2]','x');
            case 4
                Shape = inline('[ ((2*x - 1)*(4*x - 1)*(4*x - 3)*(x - 1))/3, (x*(2*x - 1)*(4*x - 1)*(4*x - 3))/3, -(16*x*(2*x - 1)*(4*x - 3)*(x - 1))/3, 4*x*(4*x - 1)*(4*x - 3)*(x - 1), -(16*x*(2*x - 1)*(4*x - 1)*(x - 1))/3]','x');
                ShapeDerivX = inline('[ ((8*x - 5)*(16*x^2 - 20*x + 5))/3, ((8*x - 3)*(16*x^2 - 12*x + 1))/3, - (512*x^3)/3 + 288*x^2 - (416*x)/3 + 16, 4*(2*x - 1)*(32*x^2 - 32*x + 3), - (512*x^3)/3 + 224*x^2 - (224*x)/3 + 16/3]','x');
        end
    case 2
        switch p
            case 1
                Shape = inline('[ 1 - y - x, x, y]','x','y');
                ShapeDerivX = inline('[-1, 1, 0]','x','y');
                ShapeDerivY = inline('[-1, 0, 1]','x','y');
            case 2
                Shape = inline('[ (2*x + 2*y - 1)*(x + y - 1), x*(2*x - 1), y*(2*y - 1), 4*x*y, -4*y*(x + y - 1), -4*x*(x + y - 1)]','x','y');
                ShapeDerivX = inline('[ 4*x + 4*y - 3, 4*x - 1,       0, 4*y,          -4*y, 4 - 4*y - 8*x]','x','y');
                ShapeDerivY = inline('[ 4*x + 4*y - 3,       0, 4*y - 1, 4*x, 4 - 8*y - 4*x,          -4*x]','x','y');               
            case 3
                Shape = inline('[ -((3*x + 3*y - 1)*(3*x + 3*y - 2)*(x + y - 1))/2, (x*(3*x - 1)*(3*x - 2))/2, (y*(3*y - 1)*(3*y - 2))/2, (9*x*y*(3*x - 1))/2, (9*y*(3*x + 3*y - 2)*(x + y - 1))/2, (9*x*(3*x + 3*y - 2)*(x + y - 1))/2, (9*x*y*(3*y - 1))/2, -(9*y*(3*y - 1)*(x + y - 1))/2, -(9*x*(3*x - 1)*(x + y - 1))/2, -27*x*y*(x + y - 1)]','x','y');
                ShapeDerivX = inline('[ 18*x + 18*y - 27*x*y - (27*x^2)/2 - (27*y^2)/2 - 11/2, (27*x^2)/2 - 9*x + 1,                    0, (9*y*(6*x - 1))/2,                                (9*y*(6*x + 6*y - 5))/2, (81*x^2)/2 + 54*x*y - 45*x + (27*y^2)/2 - (45*y)/2 + 9, (9*y*(3*y - 1))/2,                         -(9*y*(3*y - 1))/2, 36*x + (9*y)/2 - 27*x*y - (81*x^2)/2 - 9/2, -27*y*(2*x + y - 1)]','x','y');
                ShapeDerivY = inline('[ 18*x + 18*y - 27*x*y - (27*x^2)/2 - (27*y^2)/2 - 11/2,                    0, (27*y^2)/2 - 9*y + 1, (9*x*(3*x - 1))/2, (27*x^2)/2 + 54*x*y - (45*x)/2 + (81*y^2)/2 - 45*y + 9,                                (9*x*(6*x + 6*y - 5))/2, (9*x*(6*y - 1))/2, (9*x)/2 + 36*y - 27*x*y - (81*y^2)/2 - 9/2,                         -(9*x*(3*x - 1))/2, -27*x*(x + 2*y - 1)]','x','y');
            case 4
                Shape = inline('[ ((2*x + 2*y - 1)*(4*x + 4*y - 1)*(4*x + 4*y - 3)*(x + y - 1))/3, (x*(2*x - 1)*(4*x - 1)*(4*x - 3))/3, (y*(2*y - 1)*(4*y - 1)*(4*y - 3))/3, (16*x*y*(2*x - 1)*(4*x - 1))/3, -(16*y*(2*x + 2*y - 1)*(4*x + 4*y - 3)*(x + y - 1))/3, -(16*x*(2*x + 2*y - 1)*(4*x + 4*y - 3)*(x + y - 1))/3, 4*x*y*(4*x - 1)*(4*y - 1), 4*y*(4*y - 1)*(4*x + 4*y - 3)*(x + y - 1), 4*x*(4*x - 1)*(4*x + 4*y - 3)*(x + y - 1), 32*x*y*(4*x + 4*y - 3)*(x + y - 1), (16*x*y*(2*y - 1)*(4*y - 1))/3, -(16*y*(2*y - 1)*(4*y - 1)*(x + y - 1))/3, -(16*x*(2*x - 1)*(4*x - 1)*(x + y - 1))/3, -32*x*y*(4*x - 1)*(x + y - 1), -32*x*y*(4*y - 1)*(x + y - 1)]','x','y');
                ShapeDerivX = inline('[ ((8*x + 8*y - 5)*(16*x^2 + 32*x*y - 20*x + 16*y^2 - 20*y + 5))/3, ((8*x - 3)*(16*x^2 - 12*x + 1))/3,                                 0, (16*y*(24*x^2 - 12*x + 1))/3,                                                       -(16*y*(24*x^2 + 48*x*y - 36*x + 24*y^2 - 36*y + 13))/3, - (512*x^3)/3 - 384*x^2*y + 288*x^2 - 256*x*y^2 + 384*x*y - (416*x)/3 - (128*y^3)/3 + 96*y^2 - (208*y)/3 + 16, 4*y*(8*x - 1)*(4*y - 1),                      4*y*(4*y - 1)*(8*x + 8*y - 7), 4*(2*x + y - 1)*(32*x*y - 4*y - 32*x + 32*x^2 + 3), 32*y*(12*x^2 + 16*x*y - 14*x + 4*y^2 - 7*y + 3), (16*y*(2*y - 1)*(4*y - 1))/3,                                            -(16*y*(2*y - 1)*(4*y - 1))/3, 64*x*y - (16*y)/3 - (224*x)/3 - 128*x^2*y + 224*x^2 - (512*x^3)/3 + 16/3, -32*y*(8*x*y - y - 10*x + 12*x^2 + 1),         -32*y*(4*y - 1)*(2*x + y - 1)]','x','y');
                ShapeDerivY = inline('[ ((8*x + 8*y - 5)*(16*x^2 + 32*x*y - 20*x + 16*y^2 - 20*y + 5))/3,                                 0, ((8*y - 3)*(16*y^2 - 12*y + 1))/3, (16*x*(2*x - 1)*(4*x - 1))/3, - (128*x^3)/3 - 256*x^2*y + 96*x^2 - 384*x*y^2 + 384*x*y - (208*x)/3 - (512*y^3)/3 + 288*y^2 - (416*y)/3 + 16,                                                       -(16*x*(24*x^2 + 48*x*y - 36*x + 24*y^2 - 36*y + 13))/3, 4*x*(4*x - 1)*(8*y - 1), 4*(x + 2*y - 1)*(32*x*y - 32*y - 4*x + 32*y^2 + 3),                      4*x*(4*x - 1)*(8*x + 8*y - 7), 32*x*(4*x^2 + 16*x*y - 7*x + 12*y^2 - 14*y + 3), (16*x*(24*y^2 - 12*y + 1))/3, 64*x*y - (224*y)/3 - (16*x)/3 - 128*x*y^2 + 224*y^2 - (512*y^3)/3 + 16/3,                                            -(16*x*(2*x - 1)*(4*x - 1))/3,         -32*x*(4*x - 1)*(x + 2*y - 1), -32*x*(8*x*y - 10*y - x + 12*y^2 + 1)]','x','y');
        end  
end